import{v as u}from"./index-CtQclHPH.js";const l=u("userSignup",{state:()=>({users:JSON.parse(localStorage.getItem("users"))||[],otpStorage:{},currentUser:JSON.parse(localStorage.getItem("currentUser"))||null,signupSuccess:!1,signupError:null,loginError:null}),getters:{isLoggedIn(){return!!this.currentUser},firstName:s=>{var r;return((r=s.currentUser)==null?void 0:r.firstName)||""},lastName:s=>{var r;return((r=s.currentUser)==null?void 0:r.lastName)||""},profileImage:s=>localStorage.getItem("profileImage")||"default-image.png"},actions:{saveUsersToLocalStorage(){localStorage.setItem("users",JSON.stringify(this.users))},saveCurrentUserToLocalStorage(){localStorage.setItem("currentUser",JSON.stringify(this.currentUser))},signUp(s,r,e,t){const a=this.users.some(o=>o.email===e),i=this.users.some(o=>o.firstName===s&&o.lastName===r);if(a)this.signupError="User with this email already exists.",this.signupSuccess=!1;else if(i)this.signupError="Name is already taken.",this.signupSuccess=!1;else{const o={firstName:s,lastName:r,email:e,password:t};this.users.push(o),this.saveUsersToLocalStorage(),this.signupSuccess=!0,this.signupError=null}},signIn(s,r){const e=this.users.find(t=>t.email===s&&t.password===r);e?(this.currentUser=e,this.loginError=null,this.saveCurrentUserToLocalStorage()):this.loginError="Invalid email or password."},generateOTP(s=6){return Array.from({length:s},()=>Math.floor(Math.random()*10)).join("")},sendOTP(s){const r=this.users.find(e=>e.email===s);if(r){const e=this.generateOTP();return r.otp=e,this.otpStorage[s]=e,console.log(`OTP for ${s}: ${e}`),{success:!0,message:"OTP sent to your email."}}else return{success:!1,message:"Email not registered."}},verifyOTP(s,r){const e=this.users.find(t=>t.email===s);return e&&e.otp===r?(e.otp=null,delete this.otpStorage[s],{success:!0,message:"OTP verified successfully."}):{success:!1,message:"Invalid or expired OTP."}},resetPassword(s,r){const e=this.users.find(t=>t.email===s);return e?(e.password=r,this.saveUsersToLocalStorage(),{success:!0,message:"Password reset successfully."}):{success:!1,message:"Email not found."}},logout(){this.currentUser=null,localStorage.removeItem("currentUser")}}});export{l as u};
